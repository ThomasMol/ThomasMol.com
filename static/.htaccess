<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /
  RewriteCond %{HTTP_HOST} ^www\.(.*)$ [NC]
  RewriteRule ^(.*)$ https://%1/\$1 [R=301,L]
  
  # Remove .html extension from URLs
  RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /.*\.html\ HTTP/
  RewriteRule ^(.*)\.html$ /\$1 [R=301,L]
  
  # Rewrite non-existent URLs without the .html extension to their .html counterpart
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteCond %{REQUEST_FILENAME}\.html -f
  RewriteRule ^(.*)$ \$1.html [L]

  # Redirect non-existing pages to 404.html
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteRule ^ 404.html [L]
</IfModule>